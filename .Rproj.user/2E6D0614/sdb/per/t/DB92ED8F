{
    "collab_server" : "",
    "contents" : "install.packages(\"ggplot2\")\ninstall.packages(\"psych\")\ninstall.packages(\"lsmeans\")\ninstall.packages(\"prevalence\")\ninstall.packages(\"plyr\")\ninstall.packages(\"aod\")\ninstall.packages(\"binom\")\ninstall.packages(\"wordcloud\")\ninstall.packages(\"stringr\")\n\nlibrary(ggplot2)\nlibrary(psych)\nlibrary(lsmeans)\nlibrary(prevalence)\nlibrary(plyr)\nlibrary(aod)\nlibrary(binom)\nlibrary(\"wordcloud\")\nlibrary(stringr)\n\ntov <- read.csv(\"C:/Users/Genevieve/Documents/R/TOVR1.csv\")\ntov.noNA <- read.csv(\"C:/Users/Genevieve/Documents/R/TOVnoNA.csv\")\n\ntov$pos <- ifelse(tov$Ct.Mean < 35.00, 1, 0)\ntov$sampfull <- tov$Sample\ntov$Sampfull <- paste(tov$sampfull, \" \", tov$Stage)\ntov.uniq <- tov[!duplicated(tov$Sampfull),]\n\ntov.noNA$sampfull <- tov.noNA$Sample\ntov.noNA$Sampfull <- paste(tov.noNA$sampfull, \" \", tov.noNA$Stage)\ntov.noNA.uniq <- tov.noNA[!duplicated(tov.noNA$Sampfull),]\n\ntov.noNA.uniq.1 <- sapply(strsplit(as.character(tov.noNA.uniq$Sample), \"\"), tail, 3)\ntov.noNA.uniq$SampType <- tov.noNA.uniq.1[1,]\n\n#Sample distribution counts\nxtabs(~ Cycle + SampType, tov.noNA.uniq)\n\n\nmean(tov.uniq$Ct.Mean, na.rm = TRUE)\n# 38.00604\n\nmean(tov.uniq$Ct.Dev, na.rm = TRUE)\n#0.8540\n\nmean(tov.uniq$R2, na.rm = TRUE)\n#0.9211\n\npos <- subset(tov, tov$Ct.Mean < 35.01)\ntov.pos.uniq <- pos[!duplicated(pos$Sample),]\n\nbinom.confint()\n#G2 im 33 pup probs artifact\n\n#freq barplot of pos\nbarplot(table(tov.pos.uniq$Temp), main = \"Positive Cases by Temperature\", xlab = \"Temperature\")\nbarplot(table(tov.pos.uniq$Cycle), main = \"Positive Cases by Gonotropic Cycle\", xlab = \"Cycle\")\nbarplot(table(tov.pos.uniq$Day), main = \"Positive Cases by Day\", xlab = \"Day\")\n\n#plot of cases by day\npos.day <- matrix(c(0,3,7,14,1,10,2,4), ncol = 2)\ncolnames(pos.day) <- c(\"Day\", \"Positive Cases\")\nplot(pos.day[,1], pos.day[,2])\n\n#Subsetting, graphing positives\n#,text(Ct.Mean, R2,labels = tov.G1.3.uniq$Sample, cex = 0.7, pos = 2))\n\ntov.G1im <- subset(tov, tov$Stage == \"G1 im\")\ntov.G1im.uniq <- tov.G1im[!duplicated(tov.G1im$Sample),]\n\nplot(y = tov.G1im.uniq$R2, x =tov.G1im.uniq$Ct.Mean, pch = 1,cex=0.75, col =\"grey\", \n     xlim=c(20,45), ylim=c(0.7,1), ylab=\"R2 value\", xlab=\"Ct Mean value\", main=\"G1 immatures\")\nwith(subset(tov.G1im.uniq, tov.G1im.uniq$Ct.Mean>=35.01), \n     points(y = R2, x = Ct.Mean,\n            pch=20, cex = 0.75, col=\"blue\"))\nwith(subset(tov.G1im.uniq, tov.G1im.uniq$Ct.Mean<35.01), \n     points(y = R2, x = Ct.Mean, \n            pch=20, cex = 0.75, col=\"red\"),\n     textxy(Ct.Mean, R2,labels = Sample, cex = 0.7, pos = 2))\nabline(v=35.0, col=\"black\", lty=2, lwd=2)\n\n\ntov.G1.3 <- subset(tov, tov$Stage == \"G1 3\")\ntov.G1.3.uniq <- tov.G1.3[!duplicated(tov.G1.3$Sample),]\ntov.G1.3.uniq.pos <- subset(tov.G1.3.uniq, tov.G1.3.uniq$Ct.Mean < 35.01)\n\nwith(tov.G1.3.uniq, plot(y = tov.G1.3.uniq$R2, x =tov.G1.3.uniq$Ct.Mean, pch = 1,cex=0.75, col =\"grey\", \n     xlim=c(20,45), ylim=c(0.7,1), ylab=\"R2 value\", xlab=\"Ct Mean value\", main=\"G1 3 day\"))\ntext(tov.G1.3.uniq.pos[,c(4,9)], labels = tov.G1.3.uniq.pos[,2], pos = 2)\nwith(subset(tov.G1.3.uniq, tov.G1.3.uniq$Ct.Mean>=35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"blue\"))\nwith(subset(tov.G1.3.uniq, tov.G1.3.uniq$Ct.Mean<35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"red\"))\nabline(v=35.0, col=\"black\", lty=2, lwd=2)\n\n\ntextplot(tov.G1.3.uniq$Ct.Mean, tov.G1.3.uniq$R2, tov.G1.3.uniq$Sample)\nwith(subset(tov.G1.3.uniq, tov.G1.3.uniq$Ct.Mean>=35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"blue\"))\nwith(subset(tov.G1.3.uniq, tov.G1.3.uniq$Ct.Mean<35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"red\"))\nabline(v=35.0, col=\"black\", lty=2, lwd=2)\n\n\n\ntov.G1.7 <- subset(tov, tov$Stage == \"G1 7\")\ntov.G1.7.uniq <- tov.G1.7[!duplicated(tov.G1.7$Sample),]\n\nplot(y = tov.G1.7.uniq$R2, x =tov.G1.7.uniq$Ct.Mean, pch = 1,cex=0.75, col =\"grey\", \n     xlim=c(20,45), ylim=c(0.7,1), ylab=\"R2 value\", xlab=\"Ct Mean value\", main=\"G1 7 day\")\nwith(subset(tov.G1.7.uniq, tov.G1.7.uniq$Ct.Mean>=35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"blue\"))\nwith(subset(tov.G1.7.uniq, tov.G1.7.uniq$Ct.Mean<35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"red\"))\nabline(v=35.0, col=\"black\", lty=2, lwd=2)\n\n\ntov.G1.14 <- subset(tov, tov$Stage == \"G1 14\")\ntov.G1.14.uniq <- tov.G1.14[!duplicated(tov.G1.14$Sample),]\n\nplot(y = tov.G1.14.uniq$R2, x =tov.G1.14.uniq$Ct.Mean, pch = 1,cex=0.75, col =\"grey\", \n     xlim=c(20,45), ylim=c(0.7,1), ylab=\"R2 value\", xlab=\"Ct Mean value\", main=\"G1 14 day\")\nwith(subset(tov.G1.14.uniq, tov.G1.14.uniq$Ct.Mean>=35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"blue\"))\nwith(subset(tov.G1.14.uniq, tov.G1.14.uniq$Ct.Mean<35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"red\"))\nabline(v=35.0, col=\"black\", lty=2, lwd=2)\n\ntov.G2im <- subset(tov, tov$Stage == \"G2 im\")\ntov.G2im.uniq <- tov.G2im[!duplicated(tov.G2im$Sample),]\n\nplot(y = tov.G2im.uniq$R2, x =tov.G2im.uniq$Ct.Mean, pch = 1,cex=0.75, col =\"grey\", \n     xlim=c(20,45), ylim=c(0.7,1), ylab=\"R2 value\", xlab=\"Ct Mean value\", main=\"G2 immatures\")\nwith(subset(tov.G2im.uniq, tov.G2im.uniq$Ct.Mean>=35.01), \n     points(y = R2, x = Ct.Mean,\n            pch=20, cex = 0.75, col=\"blue\"))\nwith(subset(tov.G2im.uniq, tov.G2im.uniq$Ct.Mean<35.01), \n     points(y = R2, x =Ct.Mean,\n            pch=20, cex = 0.75, col=\"red\"))\nabline(v=35.0, col=\"black\", lty=2, lwd=2)\n\n\ntov.G2.3 <- subset(tov, tov$Stage == \"G2 3\")\ntov.G2.3.uniq <- tov.G2.3[!duplicated(tov.G2.3$Sample),]\n\nplot(y = tov.G2.3.uniq$R2, x =tov.G2.3.uniq$Ct.Mean, pch = 1,cex=0.75, col =\"grey\", \n     xlim=c(20,45), ylim=c(0.7,1), ylab=\"R2 value\", xlab=\"Ct Mean value\", main=\"G2 3 day\")\nwith(subset(tov.G2.3.uniq, tov.G2.3.uniq$Ct.Mean>=35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"blue\"))\nwith(subset(tov.G2.3.uniq, tov.G2.3.uniq$Ct.Mean<35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"red\"))\nabline(v=35.0, col=\"black\", lty=2, lwd=2)\n\n\ntov.G2.7 <- subset(tov, tov$Stage == \"G2 7\")\ntov.G2.7.uniq <- tov.G2.7[!duplicated(tov.G2.7$Sample),]\n\nplot(y = tov.G2.7.uniq$R2, x =tov.G2.7.uniq$Ct.Mean, pch = 1,cex=0.75, col =\"grey\", \n     xlim=c(20,45), ylim=c(0.7,1), ylab=\"R2 value\", xlab=\"Ct Mean value\", main=\"G2 7 day\")\nwith(subset(tov.G2.7.uniq, tov.G2.7.uniq$Ct.Mean>=35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"blue\"))\nwith(subset(tov.G2.7.uniq, tov.G2.7.uniq$Ct.Mean<35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"red\"))\nabline(v=35.0, col=\"black\", lty=2, lwd=2)\n\n\ntov.G2.14 <- subset(tov, tov$Stage == \"G2 14\")\ntov.G2.14.uniq <- tov.G2.14[!duplicated(tov.G2.14$Sample),]\n\nplot(y = tov.G2.14.uniq$R2, x =tov.G2.14.uniq$Ct.Mean, pch = 1,cex=0.75, col =\"grey\", \n     xlim=c(20,45), ylim=c(0.7,1), ylab=\"R2 value\", xlab=\"Ct Mean value\", main=\"G2 14 day\")\nwith(subset(tov.G2.14.uniq, tov.G2.14.uniq$Ct.Mean>=35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"blue\"))\nwith(subset(tov.G2.14.uniq, tov.G2.14.uniq$Ct.Mean<35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"red\"))\nabline(v=35.0, col=\"black\", lty=2, lwd=2)\n\n\ntov.G3.3 <- subset(tov, tov$Stage == \"G3 3\")\ntov.G3.3.uniq <- tov.G3.3[!duplicated(tov.G3.3$Sample),]\n\nplot(y = tov.G3.3.uniq$R2, x =tov.G3.3.uniq$Ct.Mean, pch = 1,cex=0.75, col =\"grey\", \n     xlim=c(20,45), ylim=c(0.7,1), ylab=\"R2 value\", xlab=\"Ct Mean value\", main=\"G3 3 day\")\nwith(subset(tov.G3.3.uniq, tov.G3.3.uniq$Ct.Mean>=35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"blue\"))\nwith(subset(tov.G3.3.uniq, tov.G3.3.uniq$Ct.Mean<35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"red\"))\nabline(v=35.0, col=\"black\", lty=2, lwd=2)\n\n\ntov.G3.7 <- subset(tov, tov$Stage == \"G3 7\")\ntov.G3.7.uniq <- tov.G3.7[!duplicated(tov.G1.7$Sample),]\n\nplot(y = tov.G3.7.uniq$R2, x =tov.G3.7.uniq$Ct.Mean, pch = 1,cex=0.75, col =\"grey\", \n     xlim=c(20,45), ylim=c(0.7,1), ylab=\"R2 value\", xlab=\"Ct Mean value\", main=\"G3 7 day\")\nwith(subset(tov.G3.7.uniq, tov.G3.7.uniq$Ct.Mean>=35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"blue\"))\nwith(subset(tov.G3.7.uniq, tov.G3.7.uniq$Ct.Mean<35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"red\"))\nabline(v=35.0, col=\"black\", lty=2, lwd=2)\n\n\ntov.G3.14 <- subset(tov, tov$Stage == \"G3 14\")\ntov.G3.14.uniq <- tov.G3.14[!duplicated(tov.G3.14$Sample),]\n\nplot(y = tov.G3.14.uniq$R2, x =tov.G3.14.uniq$Ct.Mean, pch = 1,cex=0.75, col =\"grey\", \n     xlim=c(20,45), ylim=c(0.7,1), ylab=\"R2 value\", xlab=\"Ct Mean value\", main=\"G3 14 day\")\nwith(subset(tov.G3.14.uniq, tov.G3.14.uniq$Ct.Mean>=35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"blue\"))\nwith(subset(tov.G3.14.uniq, tov.G3.14.uniq$Ct.Mean<35.01), \n     points(y = R2, x = Ct.Mean,pch=20, cex = 0.75, col=\"red\"))\nabline(v=35.0, col=\"black\", lty=2, lwd=2)\n\n#dummy var for cycles\n\ntov$G1 <- ifelse(tov$Cycle == \"G1\", 0,0)\ntov$G2 <- ifelse(tov$Cycle == \"G2\", 1,0)\ntov$G3 <- ifelse(tov$Cycle == \"G3\", 1,0)\n\ntov$tw7 <- ifelse(tov$Temp == 27, 0,0)\ntov$th0 <- ifelse(tov$Temp == 30, 1,0)\ntov$th3 <- ifelse(tov$Temp == 33, 1,0)\n\ntov$im <- ifelse(tov$Day == 0, 0,0)\ntov$three <- ifelse(tov$Day == 3, 1,0)\ntov$seven <- ifelse(tov$Day == 7, 1,0)\ntov$fourteen <- ifelse(tov$Day == 14, 1,0)\n\n#logit regress + poisson\n\nlogit.tov <-\n  glm(pos ~  three + seven + fourteen, \n      data = tov.uniq , family = \"poisson\", na.action = na.exclude)\nsummary(logit.tov)\n",
    "created" : 1498076213870.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2629581019",
    "id" : "DB92ED8F",
    "lastKnownWriteTime" : 1501303582,
    "last_content_update" : 1501303582665,
    "path" : "~/Zika TOV/pcr analysis.R",
    "project_path" : "pcr analysis.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}